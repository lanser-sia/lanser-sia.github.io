block setup
    - var store = "Lanser store"
    - var directionStart = "Get directions from:"

block lead
    h1 Sia Lanser
    p Remonts un apkope kurpes, aprīkošana papēži, remontu un tehnisko apkopi ādas izstrādājumu, bagāžas un tamlīdzīgi

div.store
    picture
        source(media="(min-width: 960px)" srcset="/static/img/store-s.jpg 1x, /static/img/store-h.jpg 2x")
        source(media="(min-width: 480px)" srcset="/static/img/store-s.jpg 1x, /static/img/store-m.jpg 2x")
        source(media="(min-width: 240px)" srcset="/static/img/store-s.jpg 2x")
        img(src="/static/img/store-m.jpg" alt="#{store}")

div#navigationPanel
    div
        label(for="start") #{directionStart}
        input#start
        input#end(value="56.948010, 24.124630" hidden="")
    div
        label Mode of Travel:
        select#mode
            option(value="DRIVING") Driving
            option(value="WALKING") Walking
            option(value="BICYCLING") Bicycling
            option(value="TRANSIT") Transit
div#map
div#directions

script.
    var map;
    function initMap() {
        var mapCenter = {lat: 56.947693, lng: 24.124859};
        var streetStart = {lat:56.94802, lng:24.12463};
        var streetEnd = {lat:56.94768, lng:24.124783};
        var entrance = {lat: 56.94765, lng: 24.1249};
        var iconPosition = {lat: 56.947593, lng: 24.125};
        var control = document.getElementById('navigationPanel');
        var directionsDisplay = new google.maps.DirectionsRenderer;
        var directionsService = new google.maps.DirectionsService;
        var onChangeHandler = function () {
            calculateAndDisplayRoute(directionsService, directionsDisplay);
        };

        map = new google.maps.Map(document.getElementById('map'), {
            center: mapCenter,
            mapTypeId: "roadmap",
            zoom: 18
        });
        directionsDisplay.setMap(map);
        directionsDisplay.setPanel(document.getElementById('directions'));
        control.style.display = 'block';
        map.controls[google.maps.ControlPosition.TOP_CENTER].push(control);
        document.getElementById('mode').addEventListener('change', onChangeHandler);
        document.getElementById('start').addEventListener('change', onChangeHandler);

        new google.maps.Polyline({
            path: [streetStart, streetEnd, entrance],
            strokeColor: '#FF0000',
            strokeOpacity: .5,
            strokeWeight: 4,
            icons: [
                {icon:{
                    path: google.maps.SymbolPath.FORWARD_CLOSED_ARROW
                }}
            ],
            map: map
        });
        new google.maps.Marker({
            position: iconPosition,
            icon: "https://lanser.lv/favicon-32x32.png",
            title: "Sia Lanser",
            animation: google.maps.Animation.BOUNCE,
            map: map
        });

        function calculateAndDisplayRoute(directionsService, directionsDisplay) {
            var start = document.getElementById('start').value;
            var end = document.getElementById('end').value;
            var mode = document.getElementById('mode').value;
            directionsService.route({
                origin: start,
                destination: end,
                travelMode: mode
            }, function (response, status) {
                if (status === 'OK') {
                    directionsDisplay.setDirections(response);
                } else {
                    console.log('Directions request failed due to ' + status);
                }
            });
        }
    }


script(async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDGbzsVZzP0b4yRMBOoqzsAwbQJmPRkOHs&callback=initMap")